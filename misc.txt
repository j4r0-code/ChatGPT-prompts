import time
import pyautogui
import win32com.client

def prevent_screensaver_and_teams_inactive():
    # Initialize the shell object to simulate keypresses
    shell = win32com.client.Dispatch("WScript.Shell")
    
    while True:
        # Simulate a harmless keypress (Shift key in this case)
        shell.SendKeys('+')
        
        # Wait for 5 minutes before simulating another keypress
        # This will prevent the screensaver from starting after 10 minutes
        # and also keep Teams status as active.
        time.sleep(300)

if __name__ == "__main__":
    # Ensure the script runs in the background without a console window
    pyautogui.FAILSAFE = False
    prevent_screensaver_and_teams_inactive()


# pip install pyautogui pywin32